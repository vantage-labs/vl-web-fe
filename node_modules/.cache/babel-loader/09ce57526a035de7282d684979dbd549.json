{"ast":null,"code":"import _classCallCheck from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _possibleConstructorReturn from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";\nimport _assertThisInitialized from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _get from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/get.js\";\nimport _getPrototypeOf from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";\nimport _inherits from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"/home/bahari/vl-web-fe/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { NativeAnimationControls, isGenerator, createGeneratorEasing, supportsLinearEasing } from 'motion-dom';\nimport { invariant, secondsToMilliseconds } from 'motion-utils';\nimport { startWaapiAnimation } from './index.mjs';\nimport { browserNumberValueTypes } from '../../../render/dom/value-types/number-browser.mjs';\nimport { getFinalKeyframe } from './utils/get-final-keyframe.mjs';\nimport { setCSSVar, setStyle } from './utils/style.mjs';\nimport { supportsPartialKeyframes } from './utils/supports-partial-keyframes.mjs';\nimport { supportsWaapi } from './utils/supports-waapi.mjs';\nvar state = new WeakMap();\n\nfunction hydrateKeyframes(valueName, keyframes, read) {\n  for (var i = 0; i < keyframes.length; i++) {\n    if (keyframes[i] === null) {\n      keyframes[i] = i === 0 ? read() : keyframes[i - 1];\n    }\n\n    if (typeof keyframes[i] === \"number\" && browserNumberValueTypes[valueName]) {\n      keyframes[i] = browserNumberValueTypes[valueName].transform(keyframes[i]);\n    }\n  }\n\n  if (!supportsPartialKeyframes() && keyframes.length < 2) {\n    keyframes.unshift(read());\n  }\n}\n\nvar defaultEasing = \"easeOut\";\n\nfunction getElementAnimationState(element) {\n  var animationState = state.get(element) || new Map();\n  state.set(element, animationState);\n  return state.get(element);\n}\n\nvar NativeAnimation = /*#__PURE__*/function (_NativeAnimationContr) {\n  _inherits(NativeAnimation, _NativeAnimationContr);\n\n  var _super = _createSuper(NativeAnimation);\n\n  function NativeAnimation(element, valueName, valueKeyframes, options) {\n    var _this;\n\n    _classCallCheck(this, NativeAnimation);\n\n    var isCSSVar = valueName.startsWith(\"--\");\n    invariant(typeof options.type !== \"string\", \"animateMini doesn't support \\\"type\\\" as a string. Did you mean to import { spring } from \\\"framer-motion\\\"?\");\n    var existingAnimation = getElementAnimationState(element).get(valueName);\n    existingAnimation && existingAnimation.stop();\n\n    var readInitialKeyframe = function readInitialKeyframe() {\n      return valueName.startsWith(\"--\") ? element.style.getPropertyValue(valueName) : window.getComputedStyle(element)[valueName];\n    };\n\n    if (!Array.isArray(valueKeyframes)) {\n      valueKeyframes = [valueKeyframes];\n    }\n\n    hydrateKeyframes(valueName, valueKeyframes, readInitialKeyframe); // TODO: Replace this with toString()?\n\n    if (isGenerator(options.type)) {\n      var generatorOptions = createGeneratorEasing(options, 100, options.type);\n      options.ease = supportsLinearEasing() ? generatorOptions.ease : defaultEasing;\n      options.duration = secondsToMilliseconds(generatorOptions.duration);\n      options.type = \"keyframes\";\n    } else {\n      options.ease = options.ease || defaultEasing;\n    }\n\n    var onFinish = function onFinish() {\n      _this.setValue(element, valueName, getFinalKeyframe(valueKeyframes, options));\n\n      _this.cancel();\n\n      _this.resolveFinishedPromise();\n    };\n\n    var init = function init() {\n      _this.setValue = isCSSVar ? setCSSVar : setStyle;\n      _this.options = options;\n\n      _this.updateFinishedPromise();\n\n      _this.removeAnimation = function () {\n        var _a;\n\n        return (_a = state.get(element)) === null || _a === void 0 ? void 0 : _a.delete(valueName);\n      };\n    };\n\n    if (!supportsWaapi()) {\n      _this = _super.call(this);\n      init();\n      onFinish();\n    } else {\n      _this = _super.call(this, startWaapiAnimation(element, valueName, valueKeyframes, options));\n      init();\n\n      if (options.autoplay === false) {\n        _this.animation.pause();\n      }\n\n      _this.animation.onfinish = onFinish;\n      getElementAnimationState(element).set(valueName, _assertThisInitialized(_this));\n    }\n\n    return _possibleConstructorReturn(_this);\n  }\n  /**\n   * Allows the returned animation to be awaited or promise-chained. Currently\n   * resolves when the animation finishes at all but in a future update could/should\n   * reject if its cancels.\n   */\n\n\n  _createClass(NativeAnimation, [{\n    key: \"then\",\n    value: function then(resolve, reject) {\n      return this.currentFinishedPromise.then(resolve, reject);\n    }\n  }, {\n    key: \"updateFinishedPromise\",\n    value: function updateFinishedPromise() {\n      var _this2 = this;\n\n      this.currentFinishedPromise = new Promise(function (resolve) {\n        _this2.resolveFinishedPromise = resolve;\n      });\n    }\n  }, {\n    key: \"play\",\n    value: function play() {\n      if (this.state === \"finished\") {\n        this.updateFinishedPromise();\n      }\n\n      _get(_getPrototypeOf(NativeAnimation.prototype), \"play\", this).call(this);\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      this.removeAnimation();\n\n      _get(_getPrototypeOf(NativeAnimation.prototype), \"cancel\", this).call(this);\n    }\n  }]);\n\n  return NativeAnimation;\n}(NativeAnimationControls);\n\nexport { NativeAnimation };","map":{"version":3,"sources":["/home/bahari/vl-web-fe/node_modules/framer-motion/dist/es/animation/animators/waapi/NativeAnimation.mjs"],"names":["NativeAnimationControls","isGenerator","createGeneratorEasing","supportsLinearEasing","invariant","secondsToMilliseconds","startWaapiAnimation","browserNumberValueTypes","getFinalKeyframe","setCSSVar","setStyle","supportsPartialKeyframes","supportsWaapi","state","WeakMap","hydrateKeyframes","valueName","keyframes","read","i","length","transform","unshift","defaultEasing","getElementAnimationState","element","animationState","get","Map","set","NativeAnimation","valueKeyframes","options","isCSSVar","startsWith","type","existingAnimation","stop","readInitialKeyframe","style","getPropertyValue","window","getComputedStyle","Array","isArray","generatorOptions","ease","duration","onFinish","setValue","cancel","resolveFinishedPromise","init","updateFinishedPromise","removeAnimation","_a","delete","autoplay","animation","pause","onfinish","resolve","reject","currentFinishedPromise","then","Promise"],"mappings":"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","sourcesContent":["import { NativeAnimationControls, isGenerator, createGeneratorEasing, supportsLinearEasing } from 'motion-dom';\nimport { invariant, secondsToMilliseconds } from 'motion-utils';\nimport { startWaapiAnimation } from './index.mjs';\nimport { browserNumberValueTypes } from '../../../render/dom/value-types/number-browser.mjs';\nimport { getFinalKeyframe } from './utils/get-final-keyframe.mjs';\nimport { setCSSVar, setStyle } from './utils/style.mjs';\nimport { supportsPartialKeyframes } from './utils/supports-partial-keyframes.mjs';\nimport { supportsWaapi } from './utils/supports-waapi.mjs';\n\nconst state = new WeakMap();\nfunction hydrateKeyframes(valueName, keyframes, read) {\n    for (let i = 0; i < keyframes.length; i++) {\n        if (keyframes[i] === null) {\n            keyframes[i] = i === 0 ? read() : keyframes[i - 1];\n        }\n        if (typeof keyframes[i] === \"number\" &&\n            browserNumberValueTypes[valueName]) {\n            keyframes[i] = browserNumberValueTypes[valueName].transform(keyframes[i]);\n        }\n    }\n    if (!supportsPartialKeyframes() && keyframes.length < 2) {\n        keyframes.unshift(read());\n    }\n}\nconst defaultEasing = \"easeOut\";\nfunction getElementAnimationState(element) {\n    const animationState = state.get(element) || new Map();\n    state.set(element, animationState);\n    return state.get(element);\n}\nclass NativeAnimation extends NativeAnimationControls {\n    constructor(element, valueName, valueKeyframes, options) {\n        const isCSSVar = valueName.startsWith(\"--\");\n        invariant(typeof options.type !== \"string\", `animateMini doesn't support \"type\" as a string. Did you mean to import { spring } from \"framer-motion\"?`);\n        const existingAnimation = getElementAnimationState(element).get(valueName);\n        existingAnimation && existingAnimation.stop();\n        const readInitialKeyframe = () => {\n            return valueName.startsWith(\"--\")\n                ? element.style.getPropertyValue(valueName)\n                : window.getComputedStyle(element)[valueName];\n        };\n        if (!Array.isArray(valueKeyframes)) {\n            valueKeyframes = [valueKeyframes];\n        }\n        hydrateKeyframes(valueName, valueKeyframes, readInitialKeyframe);\n        // TODO: Replace this with toString()?\n        if (isGenerator(options.type)) {\n            const generatorOptions = createGeneratorEasing(options, 100, options.type);\n            options.ease = supportsLinearEasing()\n                ? generatorOptions.ease\n                : defaultEasing;\n            options.duration = secondsToMilliseconds(generatorOptions.duration);\n            options.type = \"keyframes\";\n        }\n        else {\n            options.ease = options.ease || defaultEasing;\n        }\n        const onFinish = () => {\n            this.setValue(element, valueName, getFinalKeyframe(valueKeyframes, options));\n            this.cancel();\n            this.resolveFinishedPromise();\n        };\n        const init = () => {\n            this.setValue = isCSSVar ? setCSSVar : setStyle;\n            this.options = options;\n            this.updateFinishedPromise();\n            this.removeAnimation = () => { var _a; return (_a = state.get(element)) === null || _a === void 0 ? void 0 : _a.delete(valueName); };\n        };\n        if (!supportsWaapi()) {\n            super();\n            init();\n            onFinish();\n        }\n        else {\n            super(startWaapiAnimation(element, valueName, valueKeyframes, options));\n            init();\n            if (options.autoplay === false) {\n                this.animation.pause();\n            }\n            this.animation.onfinish = onFinish;\n            getElementAnimationState(element).set(valueName, this);\n        }\n    }\n    /**\n     * Allows the returned animation to be awaited or promise-chained. Currently\n     * resolves when the animation finishes at all but in a future update could/should\n     * reject if its cancels.\n     */\n    then(resolve, reject) {\n        return this.currentFinishedPromise.then(resolve, reject);\n    }\n    updateFinishedPromise() {\n        this.currentFinishedPromise = new Promise((resolve) => {\n            this.resolveFinishedPromise = resolve;\n        });\n    }\n    play() {\n        if (this.state === \"finished\") {\n            this.updateFinishedPromise();\n        }\n        super.play();\n    }\n    cancel() {\n        this.removeAnimation();\n        super.cancel();\n    }\n}\n\nexport { NativeAnimation };\n"]},"metadata":{},"sourceType":"module"}