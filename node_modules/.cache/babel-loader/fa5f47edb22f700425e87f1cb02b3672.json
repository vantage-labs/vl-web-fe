{"ast":null,"code":"import { useContext, useRef, useInsertionEffect } from 'react';\nimport { animateValue } from '../animation/animators/MainThreadAnimation.mjs';\nimport { MotionConfigContext } from '../context/MotionConfigContext.mjs';\nimport { useIsomorphicLayoutEffect } from '../utils/use-isomorphic-effect.mjs';\nimport { useMotionValue } from './use-motion-value.mjs';\nimport { isMotionValue } from './utils/is-motion-value.mjs';\nimport { frame, frameData } from '../frameloop/frame.mjs';\n\nfunction toNumber(v) {\n  if (typeof v === \"number\") return v;\n  return parseFloat(v);\n}\n/**\n * Creates a `MotionValue` that, when `set`, will use a spring animation to animate to its new state.\n *\n * It can either work as a stand-alone `MotionValue` by initialising it with a value, or as a subscriber\n * to another `MotionValue`.\n *\n * @remarks\n *\n * ```jsx\n * const x = useSpring(0, { stiffness: 300 })\n * const y = useSpring(x, { damping: 10 })\n * ```\n *\n * @param inputValue - `MotionValue` or number. If provided a `MotionValue`, when the input `MotionValue` changes, the created `MotionValue` will spring towards that value.\n * @param springConfig - Configuration options for the spring.\n * @returns `MotionValue`\n *\n * @public\n */\n\n\nfunction useSpring(source) {\n  let config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n    isStatic\n  } = useContext(MotionConfigContext);\n  const activeSpringAnimation = useRef(null);\n  const value = useMotionValue(isMotionValue(source) ? toNumber(source.get()) : source);\n  const latestValue = useRef(value.get());\n  const latestSetter = useRef(() => {});\n\n  const startAnimation = () => {\n    /**\n     * If the previous animation hasn't had the chance to even render a frame, render it now.\n     */\n    const animation = activeSpringAnimation.current;\n\n    if (animation && animation.time === 0) {\n      animation.sample(frameData.delta);\n    }\n\n    stopAnimation();\n    activeSpringAnimation.current = animateValue({\n      keyframes: [value.get(), latestValue.current],\n      velocity: value.getVelocity(),\n      type: \"spring\",\n      restDelta: 0.001,\n      restSpeed: 0.01,\n      ...config,\n      onUpdate: latestSetter.current\n    });\n  };\n\n  const stopAnimation = () => {\n    if (activeSpringAnimation.current) {\n      activeSpringAnimation.current.stop();\n    }\n  };\n\n  useInsertionEffect(() => {\n    return value.attach((v, set) => {\n      /**\n       * A more hollistic approach to this might be to use isStatic to fix VisualElement animations\n       * at that level, but this will work for now\n       */\n      if (isStatic) return set(v);\n      latestValue.current = v;\n      latestSetter.current = set;\n      frame.update(startAnimation);\n      return value.get();\n    }, stopAnimation);\n  }, [JSON.stringify(config)]);\n  useIsomorphicLayoutEffect(() => {\n    if (isMotionValue(source)) {\n      return source.on(\"change\", v => value.set(toNumber(v)));\n    }\n  }, [value]);\n  return value;\n}\n\nexport { useSpring };","map":{"version":3,"sources":["/home/bahari/vl-web-fe/node_modules/framer-motion/dist/es/value/use-spring.mjs"],"names":["useContext","useRef","useInsertionEffect","animateValue","MotionConfigContext","useIsomorphicLayoutEffect","useMotionValue","isMotionValue","frame","frameData","toNumber","v","parseFloat","useSpring","source","config","isStatic","activeSpringAnimation","value","get","latestValue","latestSetter","startAnimation","animation","current","time","sample","delta","stopAnimation","keyframes","velocity","getVelocity","type","restDelta","restSpeed","onUpdate","stop","attach","set","update","JSON","stringify","on"],"mappings":"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","sourcesContent":["import { useContext, useRef, useInsertionEffect } from 'react';\nimport { animateValue } from '../animation/animators/MainThreadAnimation.mjs';\nimport { MotionConfigContext } from '../context/MotionConfigContext.mjs';\nimport { useIsomorphicLayoutEffect } from '../utils/use-isomorphic-effect.mjs';\nimport { useMotionValue } from './use-motion-value.mjs';\nimport { isMotionValue } from './utils/is-motion-value.mjs';\nimport { frame, frameData } from '../frameloop/frame.mjs';\n\nfunction toNumber(v) {\n    if (typeof v === \"number\")\n        return v;\n    return parseFloat(v);\n}\n/**\n * Creates a `MotionValue` that, when `set`, will use a spring animation to animate to its new state.\n *\n * It can either work as a stand-alone `MotionValue` by initialising it with a value, or as a subscriber\n * to another `MotionValue`.\n *\n * @remarks\n *\n * ```jsx\n * const x = useSpring(0, { stiffness: 300 })\n * const y = useSpring(x, { damping: 10 })\n * ```\n *\n * @param inputValue - `MotionValue` or number. If provided a `MotionValue`, when the input `MotionValue` changes, the created `MotionValue` will spring towards that value.\n * @param springConfig - Configuration options for the spring.\n * @returns `MotionValue`\n *\n * @public\n */\nfunction useSpring(source, config = {}) {\n    const { isStatic } = useContext(MotionConfigContext);\n    const activeSpringAnimation = useRef(null);\n    const value = useMotionValue(isMotionValue(source) ? toNumber(source.get()) : source);\n    const latestValue = useRef(value.get());\n    const latestSetter = useRef(() => { });\n    const startAnimation = () => {\n        /**\n         * If the previous animation hasn't had the chance to even render a frame, render it now.\n         */\n        const animation = activeSpringAnimation.current;\n        if (animation && animation.time === 0) {\n            animation.sample(frameData.delta);\n        }\n        stopAnimation();\n        activeSpringAnimation.current = animateValue({\n            keyframes: [value.get(), latestValue.current],\n            velocity: value.getVelocity(),\n            type: \"spring\",\n            restDelta: 0.001,\n            restSpeed: 0.01,\n            ...config,\n            onUpdate: latestSetter.current,\n        });\n    };\n    const stopAnimation = () => {\n        if (activeSpringAnimation.current) {\n            activeSpringAnimation.current.stop();\n        }\n    };\n    useInsertionEffect(() => {\n        return value.attach((v, set) => {\n            /**\n             * A more hollistic approach to this might be to use isStatic to fix VisualElement animations\n             * at that level, but this will work for now\n             */\n            if (isStatic)\n                return set(v);\n            latestValue.current = v;\n            latestSetter.current = set;\n            frame.update(startAnimation);\n            return value.get();\n        }, stopAnimation);\n    }, [JSON.stringify(config)]);\n    useIsomorphicLayoutEffect(() => {\n        if (isMotionValue(source)) {\n            return source.on(\"change\", (v) => value.set(toNumber(v)));\n        }\n    }, [value]);\n    return value;\n}\n\nexport { useSpring };\n"]},"metadata":{},"sourceType":"module"}